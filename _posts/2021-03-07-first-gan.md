---
layout: post
title: My first GAN!
tags: [GAN]
excerpt_separator: <!--more-->
---

I've been hearing about GANs and seeing lots of incredibly well generated images from GANs in the past years, but I've never got around training one. Recently I finally have something that I want to generate, and something that GANs should be able to generate - textures.

There're a few papers on texture synthesis out there, but this one called [Spatial GAN](https://arxiv.org/pdf/1611.08207.pdf) caught my eye - mostly because of the simplicity of it. It's an earlier GAN paper and the architecture and training still mostly follows DCGAN. However, the architecture is fully convolutional, and can be used to generate different sizes of texture images at test time.

So, let's give it a try!

Let's start with this single texture from the [DTD dataset](https://www.robots.ox.ac.uk/~vgg/data/dtd/), and use random crops from it to train the GAN:

<p align="center"><img src="/assets/img/first_gan/pink_texture.png"/></p>

The first architecture I have is quite shallow: the crops from the real texture is 64x64, and the input noise to the generator has spatial dimension 16x16. The generator only scales up the noise 4x (per side), from 16x16 to 64x64.

These are some textures generated by this model, with size 64x64:

<p align="center"><img src="/assets/img/first_gan/generated1.png"/></p>

Just for fun, I mess with the standard deviation when sampling the noise for the generator. We can see the texture goes from smooth to having more constrast, with increasing stddev:

<p align="center"><img src="/assets/img/first_gan/generated2.png"/></p>

And, most crucial of all, how about the promise that we could generate texture of different sizes? Let's make something large.

<p align="center"><img src="/assets/img/first_gan/generated3.png"/></p>

Well, that's not bad, but due to how shallow the networks are, the structure of the original texture (fabric-like grids) is not captured. Let's try again with deeper networks. This time, the noise has spatial dimensions 4x4, and scale up 16x.

<p align="center"><img src="/assets/img/first_gan/generated4.png"/></p>

Looks like a nice piece of fabric :)

With more textures in the training set, we can also generate a range of textures:

<p align="center"><img src="/assets/img/first_gan/generated5.png"/></p>

And that was my first GAN experience. Looking forward to try out more recent GANs :)

